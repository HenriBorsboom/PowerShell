$Servers = @()
$Servers += ,('cb0218')
$Servers += ,('CBSTBDMCSPRD01')
$Servers += ,('CBSTBDMTCPRD')
$Servers += ,('CBWLPPRAPW062')
$Servers += ,('CBWLPPRAPW121')
$Servers += ,('CBWLPPRAPW122')
$Servers += ,('cbwlpprapw491')
$Servers += ,('cbwlpprapw492')
$Servers += ,('cbwlpprwfw089')
$Servers += ,('cbwlpprwfw092')
$Servers += ,('cbwlpprwfw099')
$Servers += ,('cbwlpprwfw100')
$Servers += ,('ccprdapp239')
$Servers += ,('ccprdapp320')
$Servers += ,('ccprdapp321')
$Servers += ,('ccprdwf047')
$Servers += ,('ccprdwf048')
$Servers += ,('cbvmpprapw068')
$Servers += ,('cbvmpprapw069')
$Servers += ,('cbvmpprapw142')
$Servers += ,('cbvmpprapw143')
$Servers += ,('cbvmpprapw144')
$Servers += ,('cbvmpprapw145')
$Servers += ,('cbvmpprapw146')
$Servers += ,('cbvmpprapw157')
$Servers += ,('ccprdapp138')
$Servers += ,('ccprdwf032')
$Servers += ,('ccprdwf033')
$Servers += ,('CBPO')
$Servers += ,('CBPORT02')
$Servers += ,('CBPOST02')
$Servers += ,('cbvmpprdbw017')
$Servers += ,('CBWLPPRAPW127')
$Servers += ,('CBWLPPRDBW053')
$Servers += ,('ccprdapp282')
$Servers += ,('ccprdapp034')
$Servers += ,('ccprdapp062')
$Servers += ,('CBDBPPRDBW007')
$Servers += ,('CBDBPPRDBW045')
$Servers += ,('CBDBPPRDBW046')
$Servers += ,('CBDBPPRDBW047')
$Servers += ,('cbvmpprdbw008')
$Servers += ,('CBWLPPRAPW051')
$Servers += ,('cbwlpprdbw244')
$Servers += ,('cbwlpprdbw245')
$Servers += ,('ccprddb083')
$Servers += ,('CCPRDDB089')
$Servers += ,('ccprddb093')
$Servers += ,('CBDMAS01')
$Servers += ,('CBDMDB01')
$Servers += ,('CBDXCP01')
$Servers += ,('CBDXMS01')
$Servers += ,('CBFP01')
$Servers += ,('CBFP02')
$Servers += ,('CBSTBFSFIN01')
$Servers += ,('cbwlpprapw493')
$Servers += ,('cbwlpprapw594')
$Servers += ,('cbwlpprapw601')
$Servers += ,('cbwlpprapw632')
$Servers += ,('CCPRDAPP131')
$Servers += ,('CCPRDAPP180')
$Servers += ,('ccprdapp187')
$Servers += ,('ccprdapp228')
$Servers += ,('CCPRDDB018')
$Servers += ,('CBWLPPRAPW027')
$Servers += ,('cbwlpprapw650')
$Servers += ,('cbwlpprwfw064')
$Servers += ,('cbwlpprwfw065')
$Servers += ,('cbwlpprwfw066')
$Servers += ,('cbwlpprwfw067')
$Servers += ,('CBPAM01BLIS')
#$Servers += ,('CBSTBCA01')
#$Servers += ,('CBSTBCE01')
$Servers += ,('cbvmpprapw145')
$Servers += ,('cbvmpprapw146')
$Servers += ,('CBWLPPRAPW011')
$Servers += ,('CBWLPPRAPW022')
$Servers += ,('CBWLPPRAPW024')
$Servers += ,('CBWLPPRAPW025')
$Servers += ,('CBWLPPRAPW047')
$Servers += ,('CBWLPPRAPW155')
$Servers += ,('CBWLPPRAPW162')
$Servers += ,('CBWLPPRAPW168')
$Servers += ,('cbwlpprapw325')
$Servers += ,('cbwlpprapw326')
$Servers += ,('cbwlpprapw389')
$Servers += ,('cbwlpprapw393')
$Servers += ,('cbwlpprapw431')
$Servers += ,('cbwlpprapw432')
$Servers += ,('cbwlpprapw466')
$Servers += ,('cbwlpprapw491')
$Servers += ,('cbwlpprapw492')
$Servers += ,('cbwlpprapw647')
$Servers += ,('cbwlpprapw648')
$Servers += ,('cbwlpprapw649')
$Servers += ,('cbwlpprapw651')
$Servers += ,('cbwlpprapw652')
$Servers += ,('CBWLPPRWFW039')
$Servers += ,('cbwlpprwfw063')
$Servers += ,('cbwlpprwfw109')
$Servers += ,('ccprdapp037')
$Servers += ,('ccprdapp082')
$Servers += ,('ccprdapp084')
$Servers += ,('ccprdapp089')
$Servers += ,('ccprdapp090')
$Servers += ,('ccprdapp091')
$Servers += ,('ccprdapp127')
$Servers += ,('ccprdwf002')
$Servers += ,('ccprdwf003')
$Servers += ,('CBNXB01')
$Servers += ,('CBPORT')
$Servers += ,('CBPOST01')
$Servers += ,('cbvmpprdbw016')
$Servers += ,('CBWLPPRDBW052')
$Servers += ,('CBCAPRDB01')
$Servers += ,('CBDBPPRDBW018')
$Servers += ,('CBDBPPRDBW021')
$Servers += ,('CBSTBEUCMAN01')
$Servers += ,('cbvmpprdbw002')
$Servers += ,('cbvmpprdbw003')
$Servers += ,('CBWLPPRDBW039')
$Servers += ,('CBWLPPRDBW178')
$Servers += ,('CBWLPPRDBW179')
$Servers += ,('cbwlpprdbw187')
$Servers += ,('cbwlpprdbw224')
$Servers += ,('cbwlpprdbw225')
$Servers += ,('cbwlpprdbw253')
$Servers += ,('cbwlpprdbw269')
$Servers += ,('cbwlpprdbw270')
$Servers += ,('cbwlpprdbw293')
$Servers += ,('cbwlpprdbw297')
$Servers += ,('cbwlpprdbw300')
$Servers += ,('cbwlpprdbw301')
$Servers += ,('cbwlpprdbw309')
$Servers += ,('cbwlpprdbw319')
$Servers += ,('ccprddb009')
$Servers += ,('CBWLPPRAPW057')
$Servers += ,('CBWLPPRAPW058')
$Servers += ,('CBWLPPRAPW060')
$Servers += ,('CBWLPPRAPW061')
$Servers += ,('cbwlpprapw484')



# List your target servers in the array
$ReturnDetails = @()
For ($i = 0; $i -lt $Servers.Count; $i ++) {
    Write-Host (($i + 1).ToString() + '/' + $Servers.Count.ToString() + ' - Processing ' + $Servers[$i])

    $Results = Invoke-Command -ComputerName $servers[$i] -ScriptBlock {
        # Function to convert a CIDR prefix length to a dotted-decimal subnet mask.
        function Convert-PrefixToSubnetMask {
            param ([int]$prefix)
            $maskInt = [uint32]0
            for ($i = 0; $i -lt $prefix; $i++) {
                # Set the bit at the appropriate position
                $maskInt = $maskInt -bor (1 -shl (31 - $i))
            }
            $o1 = ($maskInt -shr 24) -band 0xFF
            $o2 = ($maskInt -shr 16) -band 0xFF
            $o3 = ($maskInt -shr 8) -band 0xFF
            $o4 = $maskInt -band 0xFF
            return "$o1.$o2.$o3.$o4"
        }

        # Retrieve IPv4 configuration for all interfaces.
        $netConfigs = Get-NetIPConfiguration
        $Details = @()
        foreach ($nic in $netConfigs) {
            # There may be multiple IPv4 addresses per interface.
            foreach ($ipInfo in $nic.IPv4Address) {
                # Retrieve DNS server addresses for the interface.
                $dnsServers = (Get-DnsClientServerAddress -InterfaceAlias $nic.InterfaceAlias -AddressFamily IPv4).ServerAddresses
            
                # Build a custom object with the desired properties.
                $Details += ,([PSCustomObject]@{
                    "Server"         = $env:COMPUTERNAME
                    "Interface"      = $nic.InterfaceAlias
                    "ConfiguredIP"   = $ipInfo.IPAddress
                    "Subnet"         = Convert-PrefixToSubnetMask -prefix $ipInfo.PrefixLength
                    "Gateway"        = if ($nic.IPv4DefaultGateway) { $nic.IPv4DefaultGateway.NextHop } else { "None" }
                    "DNS1"           = if ($dnsServers.Length -ge 1) { $dnsServers[0] } else { "None" }
                    "DNS2"           = if ($dnsServers.Length -ge 2) { $dnsServers[1] } else { "None" }
                    "DNS3"           = if ($dnsServers.Length -ge 3) { $dnsServers[2] } else { "None" }
                    "CIDR"     = "$($ipInfo.PrefixLength)"
                })
            }
        }
        Return $Details
    }
    ForEach ($Result in $Results) {
        $ReturnDetails += ,(New-Object -TypeName PSObject -Property @{
            "Server"         = $Result.Server
            "Interface"      = $Result.Interface
            "ConfiguredIP"   = $Result.ConfiguredIP
            "Subnet"         = $Result.Subnet
            "Gateway"        = $Result.Gateway
            "DNS1"           = $Result.DNS1
            "DNS2"           = $Result.DNS2
            "DNS3"           = $Result.DNS3
            "CIDR"           = $Result.CIDR
        })
    }
}

$ReturnDetails | Select-Object Server, Interface, ConfiguredIP, Subnet, Gateway, DNS1, DNS2, DNS3, CIDR | Out-GridView